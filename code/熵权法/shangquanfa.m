close all
clear all
clc
x=[0.7883 0.7633 0.4745 0.8246 0.8791 0.9538 0.8785 0.6305 0.8928 
   0.7391 0.7287 0.5126 0.7603 0.8736 0.9257 0.8542 0.6187 0.7831 
   0.8111 0.7629 0.881  0.6888 0.8183 0.9285 0.8537 0.6313 0.5608  
   0.6587 0.8552 0.8903 0.8977 0.9446 0.9434 0.9027 0.7415 0.8419  
   0.6543 0.7564 0.8288 0.7926 0.9202 0.9154 0.8729 0.6398 0.8464  
   0.8259 0.7455 0.785  0.7856 0.9263 0.8871 0.8485 0.6142 0.7616 
   0.8486 0.78   0.8032 0.6509 0.9185 0.9357 0.8473 0.5734 0.8234  
   0.6834 0.949  0.8862 0.8902 0.9505 0.876  0.9044 0.898  0.6384  
   0.8495 0.8918 0.3987 0.6799 0.862  0.9579 0.8866 0.6186 0.9604
   0.7846 0.8954 0.397  0.9877 0.8873 0.9741 0.9035 0.7382 0.8514];
[hang,lie]=size(x);
for i=1:hang
    for j=1:lie
        y(i,j)=(x(i,j)-min(x(:,j)))/(max(x(:,j))-min(x(:,j)));%数据标准化
    end
end
for j=1:lie
    for i=1:hang
        p(i,j)=x(i,j)/sum(x(:,j));%计算指标权值比重
    end
end
k=1/log(hang);
for j=1:lie
        e(j)=-k*sum((p(:,j).*log(p(:,j))));%j个指标的熵值
end
he=0;
for j=1:lie
    he=he+(1-e(j));
end
for j=1:lie
    w(j)=(1-e(j))/he;
end
disp([num2str(lie),'个指标的权重分别为：'])
disp(w)
for i=1:hang
    for j=1:lie
        z(i)=sum(x(i,:).*w(j));
    end
end
disp([num2str(hang),'个项目的最终得分为：'])
disp(z)
    